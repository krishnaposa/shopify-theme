{% comment %}
Tek Matrix — Product Grid Section
Auto-detects the collection or defaults to “All Products”.
{% endcomment %}

{% assign current_collection = collection %}
{% if current_collection == nil %}
  {% assign current_collection = collections['all'] %}
{% endif %}

<section class="section main-collection">
  <div class="container">
    <h1>{{ section.settings.heading | default: "Shop All Products" }}</h1>

    {% if current_collection and current_collection.products_count > 0 %}
      <div class="grid grid--3-col">
        {% for product in current_collection.products %}
          <div class="product-card">
            <a href="{{ product.url }}">
              {{ product.featured_image | image_url: width: 500 | image_tag: class: 'product-image' }}
              <h3>{{ product.title }}</h3>
              <p class="price">{{ product.price | money }}</p>
            </a>
          </div>
        {% endfor %}
      </div>

    {% else %}
      <!-- fallback: show first 12 products from “all” collection -->
      <div class="grid grid--3-col">
        {% for product in collections['all'].products limit: 12 %}
          <div class="product-card">
            <a href="{{ product.url }}">
              {{ product.featured_image | image_url: width: 500 | image_tag: class: 'product-image' }}
              <h3>{{ product.title }}</h3>
              <p class="price">{{ product.price | money }}</p>
            </a>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Product Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop All Products"
    }
  ],
  "presets": [
    {
      "name": "Product Grid"
    }
  ]
}
{% endschema %}